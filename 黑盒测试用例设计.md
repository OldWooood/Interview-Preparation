# 黑盒测试用例设计与需求到测试用例设计流程

本文详细整理了黑盒测试用例设计的常用方法，以及接到需求后如何全面考虑测试维度和设计用例的流程。

---

## 一、黑盒测试用例设计方法

### 1. 等价类划分（Equivalence Partitioning）
**定义**：把输入数据划分为若干等价类，认为同一类中的数据对程序处理逻辑相同，测试时只需选取其中一个或少数几个代表值。

**步骤**：
1. 分析需求中的输入条件。
2. 将输入划分为有效等价类（合法输入）和无效等价类（非法输入）。
3. 在每个等价类中选择代表值作为测试用例。

**举例**：
- 输入年龄，合法范围 0~120：
  - 有效等价类：`[0,120]` → 取值如 25
  - 无效等价类：`<0`、`>120`、非数字输入（如 `"abc"`）

**注意点**：
- 有效和无效都要覆盖。
- 划分等价类时确保互不重叠，覆盖全面。

---

### 2. 边界值分析（Boundary Value Analysis）
**定义**：缺陷常出现在边界处，测试用例应关注边界点及其相邻值。

**步骤**：
1. 找出输入和输出的取值范围。
2. 取最小值、最大值及其前后相邻值。

**举例**：
- 年龄范围 0~120：
  - 最小边界：-1, 0, 1
  - 最大边界：119, 120, 121

**注意点**：
- 不能只测边界点，还要测边界附近。
- 输入、输出都可能有边界。

---

### 3. 判定表法（Decision Table Testing）
**定义**：通过列出输入条件组合及对应系统行为，生成测试用例。适用于多条件、多规则的业务逻辑。

**步骤**：
1. 列出所有条件。
2. 确定条件的可能取值（如 Y/N）。
3. 列出所有组合（用表格表示）。
4. 为每个组合确定预期输出，生成测试用例。

**举例**：
- 优惠券使用规则：
  - 条件1：订单金额≥100？
  - 条件2：用户是否会员？

| 条件1 | 条件2 | 结果 |
|-------|-------|------|
| N     | N     | 不可用 |
| N     | Y     | 不可用 |
| Y     | N     | 可用   |
| Y     | Y     | 可用   |

**注意点**：
- 条件过多时组合会爆炸，可用判定表简化技术。

---

### 4. 因果图法（Cause-Effect Graphing）
**定义**：把输入条件看作“原因”，输出结果看作“结果”，用图表示因果关系，再转化为判定表生成用例。

**步骤**：
1. 提取条件（Cause）和结果（Effect）。
2. 用逻辑关系（与、或、非）画图。
3. 转换成判定表，设计测试用例。

**举例**：
- C1：密码长度 ≥ 8  
- C2：密码包含数字  
- E1：登录成功  

关系：C1 AND C2 → E1  

测试用例：
- (C1=Y, C2=Y) → 成功  
- (C1=Y, C2=N) → 失败  
- (C1=N, C2=Y) → 失败  
- (C1=N, C2=N) → 失败  

**注意点**：
- 适合逻辑复杂的输入条件。
- 常用于安全、业务校验。

---

### 5. 错误推测法（Error Guessing）
**定义**：基于经验或直觉，推测系统可能出错的地方，设计用例。

**常见场景**：
- 输入为空值（null, ""）
- 输入超长
- 特殊字符（!@#$%^&*）
- SQL 注入、XSS 等安全输入
- 文件上传（大文件、零字节文件、非法格式）

**举例**：
- 登录接口输入用户名：空格、emoji、SQL 语句 → 检查系统是否报错或被绕过

**注意点**：
- 高度依赖经验
- 适合作为补充方法

---

### 6. 状态迁移测试（State Transition Testing）
**定义**：当系统有状态变化时，通过覆盖状态迁移路径来设计用例。

**步骤**：
1. 画出状态迁移图。
2. 列出所有状态和转换条件。
3. 设计覆盖所有状态变化的测试用例。

**举例**：
- 订单状态：
  - 待支付 → 已支付 → 已发货 → 已完成
  - 异常情况：待支付 → 已取消

**注意点**：
- 考虑非法状态迁移，例如“已完成 → 再支付”。

---

### 7. 随机测试（Monkey Testing）
**定义**：随机输入数据或操作，观察系统是否稳定。

**应用场景**：
- App 随机点击（Monkey 工具）
- 随机输入各种数据检查系统健壮性

**注意点**：
- 不保证覆盖率，但能发现稳定性问题
- 适合健壮性和压力测试

---

## 二、接到需求后测试用例设计流程

### 1. 需求分析
- 明确功能点：输入、输出、业务逻辑、流程
- 确认非功能需求：性能、安全、兼容性等

### 2. 划分测试维度
- 功能正确性（黑盒测试方法）
- 界面/交互（UI/UE）
- 异常处理与容错
- 性能、并发、稳定性
- 安全性（XSS、SQL注入、权限校验）
- 兼容性（浏览器、系统、分辨率、设备）
- 可用性（易用性、操作便利性）

### 3. 选择测试用例设计方法
| 场景 | 方法 |
|------|------|
| 输入校验 | 等价类划分 + 边界值分析 |
| 业务逻辑复杂 | 判定表法 / 因果图法 |
| 流程/状态相关 | 状态迁移测试 |
| 高风险点 | 错误推测法 / 探索性测试 |

### 4. 结合优先级安排测试
- 核心主流程：高优先级，详细设计
- 次要流程：低优先级，简化覆盖
- 边缘场景：经验法/探索性测试补充

---

### 5. 实例：用户注册功能
**需求**：
- 用户输入手机号、验证码、密码注册
- 注册成功进入首页

**测试维度设计**：
1. 输入校验
   - 手机号：等价类、边界值
   - 密码：等价类、边界值
2. 逻辑校验
   - 验证码是否过期
   - 判定表：手机号+验证码组合
3. 流程校验
   - 状态迁移：验证码过期、重复注册
4. 异常情况
   - 网络中断、接口超时
   - 错误推测：空值、超长、注入
5. 非功能测试
   - 性能：并发注册测试
   - 安全：验证码绕过

**落地方法选择**：
- 等价类 + 边界值 → 输入校验
- 判定表 → 条件组合
- 状态迁移 → 流程测试
- 错误推测 → 异常和边缘场景

---

## 三、实战建议
- 简单需求 → 等价类 + 边界值  
- 逻辑复杂 → 判定表 / 因果图  
- 流程型需求 → 状态迁移  
- 高风险功能 → 全方位 + 错误推测 + 安全测试  
- 探索性测试 → 兜底发现未知问题  

---

✅ 总结：
黑盒测试用例设计需要：
1. 全面分析需求和功能
2. 按测试维度系统覆盖
3. 根据风险和优先级选择方法
4. 结合经验补充异常和边缘情况
